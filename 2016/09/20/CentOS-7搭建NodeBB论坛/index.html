<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<link rel="stylesheet" type="text/css" href="/css/main.css?v="/>
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
<title> CentOS 7搭建NodeBB论坛 | 时针它不停在转动 </title>
</head>
<body>
<div id="">
<header id="header" class="header"><div class="header_wrapper">
<h1 class="title">
<a href="/">时针它不停在转动</a>
</h1>

<ul class="nav">


<li>
<a href="/">首页</a>
</li>


<li>
<a href="/archives">归档</a>
</li>


<li>
<a href="/about">关于</a>
</li>

</ul>
</div>
</header>
<main id="main" class="main">
<section id="content" class="content ">

  <div id="posts" class="posts-expand">
    
<article class="post">
<header class="post-header">
<h1 class="post-title">

CentOS 7搭建NodeBB论坛
</a>

</h1>
<div class="post-meta">
<span class="post-time">2016-09-20</span>
<span class="post-category">

&nbsp; | &nbsp;
<a class="post-cat-link" href="/categories/nodebb/">
nodebb
</a>

&nbsp; | &nbsp;
<a class="post-cat-link" href="/categories/nodebb/ddd/">
ddd
</a>

</span>
</div>
</header>

<span class="articleBody"><h2 id="MongoDB安装及配置"><a href="#MongoDB安装及配置" class="headerlink" title="MongoDB安装及配置"></a>MongoDB安装及配置</h2><h3 id="安装MongoDB"><a href="#安装MongoDB" class="headerlink" title="安装MongoDB"></a><a href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/" target="_blank" rel="external">安装MongoDB</a></h3><ul>
<li>配置yum源</li>
</ul>
<p>创建<code>/etc/yum.repos.d/mongodb-org-3.2.repo</code>文件，内容如下：<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="section">[mongodb-org-3.2]</span></div><div class="line"><span class="attr">name</span>=MongoDB Repository</div><div class="line"><span class="attr">baseurl</span>=https://repo.mongodb.org/yum/redhat/<span class="variable">$releasever</span>/mongodb-org/<span class="number">3.2</span>/x<span class="number">86_64</span>/</div><div class="line"><span class="attr">gpgcheck</span>=<span class="number">1</span></div><div class="line"><span class="attr">enabled</span>=<span class="number">1</span></div><div class="line"><span class="attr">gpgkey</span>=https://www.mongodb.org/static/pgp/server-<span class="number">3.2</span>.asc</div></pre></td></tr></table></figure></p>
<a id="more"></a>
<ul>
<li>yum -y install mongodb-org</li>
</ul>
<h3 id="配置MongoDB"><a href="#配置MongoDB" class="headerlink" title="配置MongoDB"></a>配置MongoDB</h3><ul>
<li>添加数据库和用户<br>当MongoDB数据库服务位于启动状态时，执行如下命令</li>
</ul>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$ </span>mongo</div><div class="line"><span class="variable">$ </span><span class="keyword">use</span> nodebb</div><div class="line"><span class="variable">$ </span>db.createUser(&#123;<span class="symbol">user:</span> <span class="string">"nodebb"</span>, <span class="symbol">pwd:</span> <span class="string">"&lt;Enter in a secure password&gt;"</span>, <span class="symbol">roles:</span> [ <span class="string">"readWrite"</span> ]&#125;)</div></pre></td></tr></table></figure>
<ul>
<li>修改配置文件<br>编辑<a href="https://docs.mongodb.com/manual/reference/configuration-options" target="_blank" rel="external">MongoDB配置文件</a><code>/etc/monogd.conf</code></li>
</ul>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#注释掉security选项，并添加认证字段</span></div><div class="line"><span class="symbol">security:</span></div><div class="line"><span class="symbol">  authorization:</span> enabled</div></pre></td></tr></table></figure>
<p>重新启动MongoDB<code>systemctl start mongod</code></p>
<h2 id="安装node-js"><a href="#安装node-js" class="headerlink" title="安装node.js"></a>安装node.js</h2><p>通过nvm管理器来安装最新版的nodejs<br><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#安装nvm</span></div><div class="line"><span class="string">curl </span><span class="string">https:</span>//<span class="string">raw.</span><span class="string">githubusercontent.</span><span class="string">com/</span><span class="string">creationix/</span><span class="string">nvm/</span><span class="string">v0.</span><span class="string">13.</span>1/<span class="string">install.</span><span class="string">sh </span>| <span class="string">bash</span></div><div class="line"><span class="string">source </span>~/.<span class="string">bash_profile</span></div><div class="line"><span class="comment">#[使用淘宝镜像解决国内nvm速度慢](https://cnodejs.org/topic/5338c5db7cbade005b023c98)</span></div><div class="line"><span class="comment">#查看版本</span></div><div class="line"><span class="string">NVM_NODEJS_ORG_MIRROR=</span><span class="string">https:</span>//<span class="string">npm.</span><span class="string">taobao.</span><span class="string">org/</span><span class="string">mirrors/</span><span class="string">node </span><span class="string">nvm </span><span class="built_in">list-remote</span></div><div class="line"><span class="comment">#安装指定版本</span></div><div class="line"><span class="string">NVM_NODEJS_ORG_MIRROR=</span><span class="string">https:</span>//<span class="string">npm.</span><span class="string">taobao.</span><span class="string">org/</span><span class="string">mirrors/</span><span class="string">node </span><span class="string">nvm </span><span class="string">install </span><span class="string">v6.</span>3.0</div></pre></td></tr></table></figure></p>
<h2 id="安装nodebb依赖"><a href="#安装nodebb依赖" class="headerlink" title="安装nodebb依赖"></a>安装nodebb依赖</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 使用epel源</span></div><div class="line">yum -y <span class="keyword">install</span> epel-release</div><div class="line"><span class="comment"># 下载依赖软件</span></div><div class="line">yum -y groupinstall <span class="string">"Development Tools"</span></div><div class="line">yum -y <span class="keyword">install</span> git ImageMagick npm</div></pre></td></tr></table></figure>
<h2 id="安装nodebb"><a href="#安装nodebb" class="headerlink" title="安装nodebb"></a>安装nodebb</h2><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 选择nodebb安装路径</span></div><div class="line">$ cd /path/to/nodebb/install/<span class="keyword">location</span></div><div class="line"><span class="title"># 下载nodebb</span>源码 -b 指定分支 </div><div class="line">$ git <span class="keyword">clone</span> <span class="title">-b</span> v1.<span class="number">0.3</span> https://github.com/NodeBB/NodeBB nodebb</div></pre></td></tr></table></figure>
<p>指定分支时，可以根据<a href="https://github.com/NodeBB/NodeBB/releases" target="_blank" rel="external">最新版本</a>进行替换</p>
<figure class="highlight tcl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># npm 安装nodebb</span></div><div class="line">$ <span class="keyword">cd</span> nodebb</div><div class="line">$ npm --<span class="keyword">registry</span>=https://<span class="keyword">registry</span>.npm.taobao.org install</div><div class="line"><span class="comment"># 初始化</span></div><div class="line">$ ./nodebb setup</div></pre></td></tr></table></figure>
<p>初始化之后，会生成config.json,可以对<a href="https://docs.nodebb.org/en/latest/configuring/config.html" target="_blank" rel="external">nodebb全局配置</a><br><code>bind_address</code>默认是<code>0.0.0.0</code>，由于nodebb和nginx位于一台服务器，为了安全起见，修改为<code>127.0.0.1</code></p>
<h2 id="nginx配置"><a href="#nginx配置" class="headerlink" title="nginx配置"></a><a href="https://docs.nodebb.org/en/latest/configuring/proxies/nginx.html" target="_blank" rel="external">nginx配置</a></h2><p>由于nginx和node.js位于一台服务器，使用如下配置</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$ </span>yum -y install nginx</div><div class="line"><span class="comment"># nginx配置文件 /etc/nginx/nginx.conf</span></div><div class="line">server &#123;</div><div class="line">    listen <span class="number">80</span>;</div><div class="line"></div><div class="line">    server_name forum.example.org;</div><div class="line"></div><div class="line">    location / &#123;</div><div class="line">        proxy_set_header X-Real-IP <span class="variable">$remote_addr</span>;</div><div class="line">        proxy_set_header X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</div><div class="line">        proxy_set_header Host <span class="variable">$http_host</span>;</div><div class="line">        proxy_set_header X-NginX-Proxy <span class="keyword">true</span>;</div><div class="line"></div><div class="line">        proxy_pass <span class="symbol">http:</span>/<span class="regexp">/127.0.0.1:4567/</span>;</div><div class="line">        proxy_redirect off;</div><div class="line"></div><div class="line">        <span class="comment"># Socket.IO Support</span></div><div class="line">        proxy_http_version <span class="number">1.1</span>;</div><div class="line">        proxy_set_header Upgrade <span class="variable">$http_upgrade</span>;</div><div class="line">        proxy_set_header Connection <span class="string">"upgrade"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="使用forever运行nodebb"><a href="#使用forever运行nodebb" class="headerlink" title="使用forever运行nodebb"></a><a href="https://docs.nodebb.org/en/latest/running/index.html#forever-daemon" target="_blank" rel="external">使用forever运行nodebb</a></h2><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 安装forever，使用国内taobao源，速度快</span></div><div class="line">$ npm <span class="comment">--registry=https://registry.npm.taobao.org install  -g forever</span></div><div class="line">$ <span class="keyword">forever</span> <span class="built_in">start</span> app.js</div></pre></td></tr></table></figure></span>

<footer class="post-footer">

<a class="post-tag-link" href="/tags/nodebb/">#nodebb</a>



<div class="post-nav">
	<div class="post-nav-prev post-nav-item">
	
    </div>
    <div class="post-nav-next post-nav-item">
    
    	<a rel="next" href="/2016/09/20/png图片结构分析/">png图片结构分析</a>
    
    </div>
</div>

</footer>
</article>


    <div class="post-spread">
      
    </div>
  </div>

</section>
</main>
<footer class="footer" id="footer">
<div class="copyright">
<i class="fa fa-copyright">2015-2017</i>
</div>
</footer>
</div>



</body>
</html>