<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<link rel="stylesheet" type="text/css" href="/css/main.css?v="/>
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
<title> 搭建git服务器 | 时针它不停在转动 </title>
</head>
<body>
<div id="">
<header id="header" class="header"><div class="header_wrapper">
<h1 class="title">
<a href="/">时针它不停在转动</a>
</h1>

<ul class="nav">


<li>
<a href="/">首页</a>
</li>


<li>
<a href="/archives">归档</a>
</li>


<li>
<a href="/about">关于</a>
</li>

</ul>
</div>
</header>
<main id="main" class="main">
<section id="content" class="content ">

  <div id="posts" class="posts-expand">
    
<article class="post">
<header class="post-header">
<h1 class="post-title">

搭建git服务器
</a>

</h1>
<div class="post-meta">
<span class="post-time">2015-11-08</span>
<span class="post-category">

&nbsp; | &nbsp;
<a class="post-cat-link" href="/categories/软件开发/">
软件开发
</a>

</span>
</div>
</header>

<span class="articleBody"><h1 id="服务端配置"><a href="#服务端配置" class="headerlink" title="服务端配置"></a>服务端配置</h1><h2 id="Git安装"><a href="#Git安装" class="headerlink" title="Git安装"></a>Git安装</h2><p>我的远程服务器是CentOS 7系统,选择使用yum方式安装</p>
<pre><code>yum install -y git
</code></pre><p>注意：不同的操作系统，请选择不同安装方式，同样也可以选择源代码安装。</p>
<h2 id="添加Git账户"><a href="#添加Git账户" class="headerlink" title="添加Git账户"></a>添加Git账户</h2><h3 id="新建用户"><a href="#新建用户" class="headerlink" title="新建用户"></a>新建用户</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="regexp">//</span>新建用户git</div><div class="line">useradd git</div><div class="line"><span class="regexp">//</span>修改git用户shell</div><div class="line">usermod -s <span class="regexp">/usr/</span>bin<span class="regexp">/git-shell</span></div></pre></td></tr></table></figure>
<p>其中，更改git用户shell是为了安全起见，因为默认新建的用户是可以远程登陆的。</p>
<h3 id="添加本地用户公钥"><a href="#添加本地用户公钥" class="headerlink" title="添加本地用户公钥"></a>添加本地用户公钥</h3><p>本地用户的密钥对默认存放在当前用户目录下~/.ssh/下,其中<em>id_rsa.pub</em>就是公钥。如果不存在，需要使用ssh-keygen生成密钥对<br>,方法如下：<br><figure class="highlight clean"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">ssh-keygen -t rsa -b <span class="number">4096</span></div><div class="line">...</div><div class="line"><span class="comment">//路径默认</span></div><div class="line"><span class="comment">//其中输入字符串可以选择为空</span></div><div class="line">...</div></pre></td></tr></table></figure></p>
<p>下一步，把生成的公钥<em>id_rsa.pub</em>,放到远程服务器/home/git/.ssh/authorized_keys文件中，可以选择scp命令<br><figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">scp local_dir/id_rsa.pub usernamet<span class="variable">@remote_ip</span><span class="symbol">:/home/git/</span>.ssh/authorized_keys</div></pre></td></tr></table></figure></p>
<p>其实，在远程服务器添加公钥，是其中免密码的认证方式，很多情况下，都用来配置免密码远程登陆服务器。</p>
<h2 id="新建git仓库"><a href="#新建git仓库" class="headerlink" title="新建git仓库"></a>新建git仓库</h2><p>选择合适的目录作为存放代码的仓库。<br><figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git init <span class="comment">--bare /srv/a.git</span></div></pre></td></tr></table></figure></p>
<p>其中<em>–bare</em>参数，只生成版本库,即只有.git目录内容</p>
<h2 id="修改仓库目录权限"><a href="#修改仓库目录权限" class="headerlink" title="修改仓库目录权限"></a>修改仓库目录权限</h2><p>为了使git用户可以修改文件，需要更改目录权限。<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chown -R <span class="string">git:</span>git <span class="regexp">/srv/</span>a.git</div></pre></td></tr></table></figure></p>
<h1 id="客户端配置"><a href="#客户端配置" class="headerlink" title="客户端配置"></a>客户端配置</h1><h2 id="Git安装-1"><a href="#Git安装-1" class="headerlink" title="Git安装"></a>Git安装</h2><p>客户端也需要安装客户端，windows下直接<a href="http://git-scm.com/download/" target="_blank" rel="external">下载</a>安装即可。<br>默认情况下，会附带右键快捷菜单Git Bash和Git Bash GUI，Git Bash提供Linux下的Bash环境，支持Linux命令。当然，前面提到的使用<em>ssh-keygen</em>windows下是不识别的，需要在Git Bash下使用。</p>
<h2 id="全局配置"><a href="#全局配置" class="headerlink" title="全局配置"></a>全局配置</h2><h3 id="新建本地仓库"><a href="#新建本地仓库" class="headerlink" title="新建本地仓库"></a>新建本地仓库</h3><p>需要选择一个目录作为仓库。<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//进入希望作为仓库的目录</span></div><div class="line">git <span class="keyword">init</span></div></pre></td></tr></table></figure></p>
<p>执行成功后，你会看到目录下回多一个<em>.git</em>目录，我们称之为版本库。<br>这样，本地的仓库就初始化成功。</p>
<h3 id="用户配置"><a href="#用户配置" class="headerlink" title="用户配置"></a>用户配置</h3><p>安装成功后，需要进行一些本地配置<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git config --global user<span class="selector-class">.name</span> <span class="string">"Your Name"</span></div><div class="line">git config --global user<span class="selector-class">.email</span> <span class="string">"Your Email"</span></div></pre></td></tr></table></figure></p>
<p>配置过后，可以使用下面命令进行确认<br><figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git config <span class="comment">--list</span></div></pre></td></tr></table></figure></p>
<h3 id="关联远程仓库"><a href="#关联远程仓库" class="headerlink" title="关联远程仓库"></a>关联远程仓库</h3><p>为了可以把本地的代码push到远程服务器，需要在本地关联远程仓库。<br><figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git remote add origin git<span class="variable">@remote_ip</span><span class="symbol">:/srv/a</span>.git</div></pre></td></tr></table></figure></p>
<p>同样你也可以使用<em>git config –list</em>来查看配置情况。</p>
<h3 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h3><p>git的使用方法较多，这里仅列出常用的几条命令，使用一段时间git后，总结使用方法。<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//添加文件</span></div><div class="line">git add &lt;filename&gt;</div><div class="line"><span class="comment">//向本地仓库提交记录</span></div><div class="line">git commit -m <span class="string">"message"</span></div><div class="line"><span class="comment">//查看当前状态</span></div><div class="line">git status</div><div class="line"><span class="comment">//查看文件差异</span></div><div class="line">git diff <span class="keyword">file</span></div><div class="line"><span class="comment">//向远程提交记录</span></div><div class="line">git <span class="keyword">push</span> origin master</div></pre></td></tr></table></figure></p>
<p>学习参考资料<br><a href="http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000" target="_blank" rel="external">廖雪峰Git教程</a><br><a href="http://www.bootcss.com/p/git-guide/" target="_blank" rel="external">git简易指南</a><br><a href="http://git-scm.com/book/en/v2" target="_blank" rel="external">专业Git–英文版</a><br><a href="http://think-like-a-git.net/" target="_blank" rel="external">像git一样思考–英文版</a></p>
</span>

<footer class="post-footer">

<a class="post-tag-link" href="/tags/git/">#git</a>



<div class="post-nav">
	<div class="post-nav-prev post-nav-item">
	
		<a rel="prev" href="/2015/12/06/Docker基础-第一篇/">Docker基础(一)</a>
	
    </div>
    <div class="post-nav-next post-nav-item">
    
    	<a rel="next" href="/2015/10/22/Mysql文件相关函数认识/">认识Mysql文件相关函数</a>
    
    </div>
</div>

</footer>
</article>


    <div class="post-spread">
      
    </div>
  </div>

</section>
</main>
<footer class="footer" id="footer">
<div class="copyright">
<i class="fa fa-copyright">2015-2017</i>
</div>
</footer>
</div>



</body>
</html>